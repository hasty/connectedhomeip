<?xml version="1.0"?>
<configurator>
  <bitmap name="Feature" type="bitmap32">
    <cluster code="0x003F"/>
    <field mask="0x1" name="CacheAndSync"/>
  </bitmap>
  <cluster>
    <attribute code="0x0000" define="GROUP_KEY_MAP" entryType="GroupKeyMapStruct" length="254" optional="false" side="server" type="ARRAY" writable="true">
      <access op="read" privilege="view"/>
      <access op="write" privilege="manage"/>
      <description>GroupKeyMap</description>
    </attribute>
    <attribute code="0x0001" define="GROUP_TABLE" entryType="GroupInfoMapStruct" length="254" optional="false" side="server" type="ARRAY" writable="false">GroupTable</attribute>
    <attribute code="0x0002" define="MAX_GROUPS_PER_FABRIC" optional="false" side="server" type="int16u" writable="false">MaxGroupsPerFabric</attribute>
    <attribute code="0x0003" define="MAX_GROUP_KEYS_PER_FABRIC" optional="false" side="server" type="int16u" writable="false">MaxGroupKeysPerFabric</attribute>
    <code>0x003F</code>
    <command cli="zcl GroupKeyManagement KeySetWrite" code="0x00" isFabricScoped="true" name="KeySetWrite" optional="false" source="client">
      <access op="invoke" privilege="administer"/>
      <arg name="GroupKeySet" type="GroupKeySetStruct"/>
      <description>Write a new set of keys for the given key set id.</description>
    </command>
    <command cli="zcl GroupKeyManagement KeySetRead" code="0x01" isFabricScoped="true" name="KeySetRead" optional="false" response="KeySetReadResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg name="GroupKeySetID" type="int16u"/>
      <description>Read the keys for a given key set id.</description>
    </command>
    <command code="0x02" disableDefaultResponse="true" name="KeySetReadResponse" optional="false" source="server">
      <arg name="GroupKeySet" type="GroupKeySetStruct"/>
      <description>
       Response to KeySetRead
      </description>
    </command>
    <command cli="zcl GroupKeyManagement KeySetRemove" code="0x03" isFabricScoped="true" name="KeySetRemove" optional="false" source="client">
      <access op="invoke" privilege="administer"/>
      <arg name="GroupKeySetID" type="int16u"/>
      <description>Revoke a Root Key from a Group</description>
    </command>
    <command cli="zcl GroupKeyManagement KeySetReadAllIndices" code="0x04" isFabricScoped="true" name="KeySetReadAllIndices" optional="false" response="KeySetReadAllIndicesResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <description>Return the list of Group Key Sets associated with the accessing fabric</description>
    </command>
    <command code="0x05" disableDefaultResponse="true" name="KeySetReadAllIndicesResponse" optional="false" source="server">
      <arg array="true" name="GroupKeySetIDs" type="int16u"/>
      <description>
        Reseponse to KeySetReadAllIndices
      </description>
    </command>
    <define>GROUP_KEY_MANAGEMENT_CLUSTER</define>
    <description>The Group Key Management Cluster is the mechanism by which group keys are managed.</description>
    <domain>General</domain>
    <name>Group Key Management</name>
  </cluster>
  <domain name="CHIP"/>
  <enum name="GroupKeySecurityPolicyEnum" type="enum8">
    <cluster code="0x003F"/>
    <item name="TrustFirst" value="0x00"/>
    <item name="CacheAndSync" value="0x01"/>
  </enum>
  <struct isFabricScoped="true" name="GroupKeyMapStruct">
    <cluster code="0x003F"/>
    <item fieldId="1" name="GroupId" type="group_id"/>
    <item fieldId="2" name="GroupKeySetID" type="int16u"/>
  </struct>
  <struct isFabricScoped="true" name="GroupInfoMapStruct">
    <cluster code="0x003F"/>
    <item fieldId="1" name="GroupId" type="group_id"/>
    <item array="true" fieldId="2" name="Endpoints" type="endpoint_no"/>
    <item fieldId="3" length="16" name="GroupName" optional="true" type="char_string"/>
  </struct>
  <struct name="GroupKeySetStruct">
    <cluster code="0x003F"/>
    <item fieldId="0" name="GroupKeySetID" type="int16u"/>
    <item fieldId="1" name="GroupKeySecurityPolicy" type="GroupKeySecurityPolicyEnum"/>
    <item fieldId="2" isNullable="true" length="16" name="EpochKey0" type="octet_string"/>
    <item fieldId="3" isNullable="true" name="EpochStartTime0" type="epoch_us"/>
    <item fieldId="4" isNullable="true" length="16" name="EpochKey1" type="octet_string"/>
    <item fieldId="5" isNullable="true" name="EpochStartTime1" type="epoch_us"/>
    <item fieldId="6" isNullable="true" length="16" name="EpochKey2" type="octet_string"/>
    <item fieldId="7" isNullable="true" name="EpochStartTime2" type="epoch_us"/>
  </struct>
</configurator>
