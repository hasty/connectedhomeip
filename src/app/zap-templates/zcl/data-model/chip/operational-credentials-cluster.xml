<?xml version="1.0"?>
<configurator>
  <cluster>
    <attribute code="0x0000" define="NOCS" entryType="NOCStruct" optional="false" side="server" type="ARRAY" writable="false">
      <access op="read" privilege="administer"/>
      <description>NOCs</description>
    </attribute>
    <attribute code="0x0001" define="FABRICS" entryType="FabricDescriptorStruct" optional="false" side="server" type="ARRAY" writable="false">Fabrics</attribute>
    <attribute code="0x0002" define="SUPPORTED_FABRICS" max="254" min="5" optional="false" side="server" type="int8u" writable="false">SupportedFabrics</attribute>
    <attribute code="0x0003" define="COMMISSIONED_FABRICS" optional="false" side="server" type="int8u" writable="false">CommissionedFabrics</attribute>
    <attribute code="0x0004" define="TRUSTED_ROOT_CERTIFICATES" entryType="octet_string" optional="false" side="server" type="ARRAY" writable="false">TrustedRootCertificates</attribute>
    <attribute code="0x0005" define="CURRENT_FABRIC_INDEX" optional="false" side="server" type="int8u" writable="false">CurrentFabricIndex</attribute>
    <code>0x003E</code>
    <command code="0x00" name="AttestationRequest" optional="false" response="AttestationResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg length="32" name="AttestationNonce" type="octet_string"/>
      <description>Sender is requesting attestation information from the receiver.</description>
    </command>
    <command code="0x01" name="AttestationResponse" optional="false" source="server">
      <arg length="900" name="AttestationElements" type="octet_string"/>
      <arg length="64" name="AttestationSignature" type="octet_string"/>
      <description>An attestation information confirmation from the server.</description>
    </command>
    <command code="0x02" name="CertificateChainRequest" optional="false" response="CertificateChainResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg name="CertificateType" type="CertificateChainTypeEnum"/>
      <description>Sender is requesting a device attestation certificate from the receiver.</description>
    </command>
    <command code="0x03" name="CertificateChainResponse" optional="false" source="server">
      <arg length="600" name="Certificate" type="octet_string"/>
      <description>A device attestation certificate (DAC) or product attestation intermediate (PAI) certificate from the server.</description>
    </command>
    <command code="0x04" name="CSRRequest" optional="false" response="CSRResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg length="32" name="CSRNonce" type="octet_string"/>
      <arg name="IsForUpdateNOC" optional="true" type="boolean"/>
      <description>Sender is requesting a certificate signing request (CSR) from the receiver.</description>
    </command>
    <command code="0x05" name="CSRResponse" optional="false" source="server">
      <arg name="NOCSRElements" type="octet_string"/>
      <arg name="AttestationSignature" type="octet_string"/>
      <description>A certificate signing request (CSR) from the server.</description>
    </command>
    <command code="0x06" name="AddNOC" optional="false" response="NOCResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg length="400" name="NOCValue" type="octet_string"/>
      <arg length="400" name="ICACValue" optional="true" type="octet_string"/>
      <arg length="16" name="IPKValue" type="octet_string"/>
      <arg name="CaseAdminSubject" type="int64u"/>
      <arg name="AdminVendorId" type="vendor_id"/>
      <description>Sender is requesting to add the new node operational certificates.</description>
    </command>
    <command code="0x07" isFabricScoped="true" name="UpdateNOC" optional="false" response="NOCResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg name="NOCValue" type="octet_string"/>
      <arg name="ICACValue" optional="true" type="octet_string"/>
      <description>Sender is requesting to update the node operational certificates.</description>
    </command>
    <command code="0x08" name="NOCResponse" optional="false" source="server">
      <arg name="StatusCode" type="NodeOperationalCertStatusEnum"/>
      <arg name="FabricIndex" optional="true" type="fabric_idx"/>
      <arg length="128" name="DebugText" optional="true" type="char_string"/>
      <description>Response to AddNOC or UpdateNOC commands.</description>
    </command>
    <command code="0x09" isFabricScoped="true" name="UpdateFabricLabel" optional="false" response="NOCResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg length="32" name="Label" type="char_string"/>
      <description>This command SHALL be used by an Administrative Node to set the user-visible Label field for a given Fabric, as reflected by entries in the Fabrics attribute.</description>
    </command>
    <command code="0x0a" name="RemoveFabric" optional="false" response="NOCResponse" source="client">
      <access op="invoke" privilege="administer"/>
      <arg name="FabricIndex" type="fabric_idx"/>
      <description>This command is used by Administrative Nodes to remove a given fabric index and delete all associated fabric-scoped data.</description>
    </command>
    <command code="0x0b" name="AddTrustedRootCertificate" optional="false" source="client">
      <access op="invoke" privilege="administer"/>
      <arg name="RootCACertificate" type="octet_string"/>
      <description>This command SHALL add a Trusted Root CA Certificate, provided as its CHIP Certificate representation.</description>
    </command>
    <define>OPERATIONAL_CREDENTIALS_CLUSTER</define>
    <description>This cluster is used to add or remove Operational Credentials on a Commissionee or Node, as well as manage the associated Fabrics.</description>
    <domain>General</domain>
    <name>Operational Credentials</name>
  </cluster>
  <domain name="CHIP"/>
  <enum name="NodeOperationalCertStatusEnum" type="enum8">
    <cluster code="0x003E"/>
    <item name="OK" value="0x00"/>
    <item name="InvalidPublicKey" value="0x01"/>
    <item name="InvalidNodeOpId" value="0x02"/>
    <item name="InvalidNOC" value="0x03"/>
    <item name="MissingCsr" value="0x04"/>
    <item name="TableFull" value="0x05"/>
    <item name="InvalidAdminSubject" value="0x06"/>
    <item name="FabricConflict" value="0x09"/>
    <item name="LabelConflict" value="0x0a"/>
    <item name="InvalidFabricIndex" value="0x0b"/>
  </enum>
  <enum name="CertificateChainTypeEnum" type="enum8">
    <cluster code="0x003E"/>
    <item name="DACCertificate" value="0x01"/>
    <item name="PAICertificate" value="0x02"/>
  </enum>
  <struct isFabricScoped="true" name="FabricDescriptorStruct">
    <cluster code="0x003E"/>
    <item fieldId="1" length="65" name="RootPublicKey" type="octet_string"/>
    <item fieldId="2" name="VendorID" type="vendor_id"/>
    <item fieldId="3" name="FabricID" type="fabric_id"/>
    <item fieldId="4" name="NodeID" type="node_id"/>
    <item fieldId="5" length="32" name="Label" type="char_string"/>
  </struct>
  <struct isFabricScoped="true" name="NOCStruct">
    <cluster code="0x003E"/>
    <item fieldId="1" isFabricSensitive="true" name="NOC" type="octet_string"/>
    <item fieldId="2" isFabricSensitive="true" isNullable="true" name="ICAC" type="octet_string"/>
  </struct>
</configurator>
